{% extends 'base.html' %}

{% block content %}
<div style="float:right"><p>Hello, {{ user.username|default:'Guest' }}!</p></div>
<div><a href="{% url 'add_business'%}">Add Business</a></div>
<br>

<h1>Your Businesses</h1>
<ul>
    {% for business in accounts %}
        <li><a href="{% url 'view_business' business.id %}">{{business.name}}</a></li>
    {% endfor %}
</ul>
<h1>Your Appointments</h1>
<ul>
    {% for appt in appointments %}
        <li>{{appt.event.name}}</li>
    {% endfor %}
</ul>

<div class="accordion" id="userAppointments">
{% for date, appt_list in appointments.items %}
<div class="accordion-item">
    <h2 class="accordion-header">    
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target='#{{ date|date:"d-m-y" }}-{{forloop.counter}}'' aria-expanded="true" aria-controls='{{ date|date:"d-m-y" }}-{{forloop.counter}}''>
        {{date}}
      </button>
    </h2>
    <div id='{{ date|date:"d-m-y" }}-{{forloop.counter}}' class="accordion-collapse collapse {% if forloop.counter == 1 %} show {% endif %}" data-bs-parent="#userAppointments">
      <div class="accordion-body">
        {% for  appt in appt_list %}
            <p>{{appt.time}} - {{appt.event.name}}</p>
        {% endfor %}
    </div>
  </div>
{% endfor %}
</div>

{% endblock %}